(self["webpackChunkmaizuo"]=self["webpackChunkmaizuo"]||[]).push([[446,666],{6769:function(t){const e=function(t,e){const i={},s="日一二三四五六";let a=new Date(t);i.year=a.getFullYear()+"年",i.month=a.getMonth()+1+"月",i.day=a.getDate()+"日",i.hour=a.getHours().toString().padStart(2,"0"),i.minute=a.getMinutes().toString().padStart(2,"0"),i.week="星期"+s.charAt(a.getDay());const n=Date.now();if(e.includes("week")){t=t-36e5*i.hour-6e4*i.minute;const e=(t-n)/1e3;e>=-86400&&e<0?i.week="今天":e>=0&&e<86400?i.week="明天":e>=86400&&e<172800&&(i.week="后天")}return e.map((t=>i[t]||t)).join("")};t.exports=e},5772:function(t,e,i){"use strict";i(2760),i(4800),i(8603)},2580:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return I}});var s=function(){var t=this,e=t._self._c;return e("div",{ref:"main",staticClass:"main"},[e("div",{staticClass:"header"},[e("span",{staticClass:"i",on:{click:function(e){return t.$router.back()}}},[e("van-icon",{attrs:{name:"arrow-left"}})],1),e("span",[t._v(t._s(t.$store.state.filmName))]),e("span",[e("van-icon",{attrs:{name:"search",size:"22",color:"black"}})],1)]),t.showCinemas.length?e("van-tabs",{attrs:{swipeable:"","title-active-color":"var(--textColor)","swipe-threshold":3,animated:!0}},t._l(t.dateList,(function(i,s){return e("van-tab",{key:s,attrs:{title:i}},[e("div",{staticClass:"filter"},[e("div",{staticClass:"tab",on:{click:function(e){t.show=!t.show}}},[t._v(" "+t._s(0===t.active?"全城":t.district)+" "),e("van-icon",{attrs:{name:t.show?"arrow-up":"arrow-down",size:"10px"}})],1),e("div",{staticClass:"tab"},[t._v("最近去过"),e("van-icon",{attrs:{name:"arrow-down",size:"10px"}})],1)]),e("van-popup",{attrs:{position:"top","get-container":`.tabList${s}`},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[e("ul",[e("li",[e("div",{class:{active:0==t.active},on:{click:function(e){return t.selectDistrict("全城",0)}}},[t._v("全部")])]),t._l(t.DistrictName,(function(i,s){return e("li",{key:s},[e("div",{class:{active:t.active==s+1},on:{click:function(e){return t.selectDistrict(i,s+1)}}},[t._v(" "+t._s(i)+" ")])])}))],2)]),e("CinemaList",{staticClass:"popupContainer",class:[`tabList${s}`],attrs:{name:i,isInclude:t.filterShowCinemas(s),height:t.getCinemaListHeight()}})],1)})),1):t._e()],1)},a=[],n=(i(2760),i(6216),i(4800),i(8603),i(7606),i(6483)),o=i(664),r=i(3389),c=i(8394),l=(0,n.Y)("popup"),h=l[0],m=l[1],u=h({mixins:[(0,r.i)()],props:{round:Boolean,duration:[Number,String],closeable:Boolean,transition:String,safeAreaInsetBottom:Boolean,closeIcon:{type:String,default:"cross"},closeIconPosition:{type:String,default:"top-right"},position:{type:String,default:"center"},overlay:{type:Boolean,default:!0},closeOnClickOverlay:{type:Boolean,default:!0}},beforeCreate:function(){var t=this,e=function(e){return function(i){return t.$emit(e,i)}};this.onClick=e("click"),this.onOpened=e("opened"),this.onClosed=e("closed")},methods:{onClickCloseIcon:function(t){this.$emit("click-close-icon",t),this.close()}},render:function(){var t,e=arguments[0];if(this.shouldRender){var i=this.round,s=this.position,a=this.duration,n="center"===s,r=this.transition||(n?"van-fade":"van-popup-slide-"+s),l={};if((0,o.C8)(a)){var h=n?"animationDuration":"transitionDuration";l[h]=a+"s"}return e("transition",{attrs:{appear:this.transitionAppear,name:r},on:{afterEnter:this.onOpened,afterLeave:this.onClosed}},[e("div",{directives:[{name:"show",value:this.value}],style:l,class:m((t={round:i},t[s]=s,t["safe-area-inset-bottom"]=this.safeAreaInsetBottom,t)),on:{click:this.onClick}},[this.slots(),this.closeable&&e(c.A,{attrs:{role:"button",tabindex:"0",name:this.closeIcon},class:m("close-icon",this.closeIconPosition),on:{click:this.onClickCloseIcon}})])])}}}),d=(i(5772),i(9331),i(690)),p=(i(6814),i(5769)),f=i(5422),w=i(7607),v=i(6769),C=i.n(v),k={components:{[p.A.name]:p.A,[d.A.name]:d.A,[c.A.name]:c.A,[u.name]:u,CinemaList:w["default"]},data(){return{showCinemas:[],dateList:[],DistrictName:[],show:!1,active:0,district:"全城"}},mounted(){(0,f.A)({url:`/gateway/?filmId=${this.$route.params.myID}&cityId=${this.$store.state.cityId}&k=1035572`,headers:{"X-Host":"mall.film-ticket.cinema.film-show-cinema"}}).then((t=>{this.showCinemas=t.data.data.showCinemas.sort(((t,e)=>t.showDate-e.showDate)),this.dateList=this.calculation()})),""===this.$store.state.filmName&&(0,f.A)({url:`/gateway?filmId=${this.$route.params.myID}&k=2914026`,headers:{"X-Host":"mall.film-ticket.film.info"}}).then((t=>{this.$store.commit("setFilmInfo",{id:+this.$route.params.myID,filmName:t.data.data.film.name})})),0===this.$store.state.cinemasData.length?this.$store.dispatch("getCinemasData",this.$store.state.cityId).then(this.getDistrictName):(this.getDistrictName(),console.log(this.DistrictName))},methods:{getCinemaListHeight(){return this.height=window.innerHeight-88-49+"px"},calculation(){return this.showCinemas.map((t=>C()(1e3*t.showDate,["week","month","day"])))},getDistrictName(){this.DistrictName=[...new Set(this.$store.state.cinemasData.map((t=>t.districtName)))].sort()},selectDistrict(t,e){this.district=t,this.active=e,this.show=!1},filterShowCinemas(t){return"全城"==this.district?this.showCinemas[t]:{cinemaList:this.$store.state.cinemasData.filter((e=>this.showCinemas[t].cinemaList.includes(e.cinemaId)&&e.districtName===this.district)).map((t=>t.cinemaId))}}}},g=k,D=i(4068),y=(0,D.A)(g,s,a,!1,null,"7ceae2d6",null),I=y.exports}}]);